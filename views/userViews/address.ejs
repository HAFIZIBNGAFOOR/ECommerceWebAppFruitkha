<%- include('../layouts/header.ejs') %>
<% if(typeof user !== "undefined"){ %>
	<%- include('userLogged') %>

<% }else{ %>
	<%- include('noUser') %>
	<% } %>
  <style>
    
    .address-card {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .address-card h4 {
      margin-bottom: 10px;
    }
    .address-card .address-info {
      color: #888;
      margin-bottom: 10px;
    }
    .address-card .edit-btn {
      margin-top: 10px;
    }

  .dropdown-toggle::after {
    content: none;
  }


  </style>
<div class="breadcrumb-section breadcrumb-bg">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 offset-lg-2  text-center">
        <div class="breadcrumb-text">
          <p>Fresh and Organic</p>
          <h1>Manage Address</h1>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container d-flex justify-content-center align-items-center ">
  <div class="card">
    <div class="card-body">
      <div class="template-demo text-center">
        <a type="button" href="/add-address?id=<%= userData._id%>" class="btn btn-outline-dark btn-fw btn-lg">Add New Address</a>
      </div>
    </div>
  </div>
</div>


<div class="container pt-3 pb-3">
  <div class="row">
    <% if (Addresses.length > 0) { %>
     <% for( let i = 0; i < Addresses.length; i++ ) { %>
     

    
    <div class="col-md-6 col-lg-8 offset-lg-2">
      <div class="address-card">
          <div class="card-body d-flex align-items-center justify-content-between">
            
            <div class="address-info">
              <h4> Address <%= i+1 %></h4>
              <h6><%= Addresses[i].name %></h6>
              <%= Addresses[i].house %><br>
              <%= Addresses[i].city%><br>
              <%= Addresses[i].state%>,<%= Addresses[i].pincode%><br>
              India
            </div> 
            <div class="address-actions">
              <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" id="shippingDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                  <span class="dots">&#8942;</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="shippingDropdown">
                  <li><a class="dropdown-item" href="/editAddress?id=<%= Addresses[i]._id %>">Edit</a></li>
                  <li><a class="dropdown-item" id="addressId" data-bs-target="#unblockBut" data-bs-toggle="modal" onclick="openDeleteModal('<%= Addresses[i]._id%>')" href="#">Delete</a></li>
                </ul>
              </div>
            </div>
            
          </div>
        
      </div>
    </div>
    <% } %>
    <% } else{%>
      <div class="col-md-6 col-lg-8 offset-lg-2">
        <h3>No Addresses Found</h3>
      </div>
      <% } %>
  </div>
</div>

  <!-- <div class="row">
    <div class="col-md-6 col-lg-8 offset-lg-2">
      <div class="address-card">
        <h4>Billing Address</h4>
        <div class="address-info">
          John Doe<br>
          456 Second Street<br>
          City, State ZIP<br>
          Country
        </div>
        <div class="dropdown">
          <button class="btn btn-primary dropdown-toggle" type="button" id="shippingDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="dots">&#8942;</span>
          </button>
          <div class="dropdown-menu" aria-labelledby="shippingDropdown">
            <a class="dropdown-item" href="#">Edit</a>
            <a class="dropdown-item" href="#">Delete</a>
          </div>
        </div>
      </div>
    </div>
  </div> -->
</div>
	<!-- logo carousel -->
	<div class="logo-carousel-section">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="logo-carousel-inner">
						<div class="single-logo-item">
							<img src="/img/company-logos/1.png" alt="">
						</div>
						<div class="single-logo-item">
							<img src="/img/company-logos/2.png" alt="">
						</div>
						<div class="single-logo-item">
							<img src="/img/company-logos/3.png" alt="">
						</div>
						<div class="single-logo-item">
							<img src="/img/company-logos/4.png" alt="">
						</div>
						<div class="single-logo-item">
							<img src="/img/company-logos/5.png" alt="">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end logo carousel -->

	<!-- footer -->
	<div class="footer-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<div class="footer-box about-widget">
						<h2 class="widget-title">About us</h2>
						<p>Ut enim ad minim veniam perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae.</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box get-in-touch">
						<h2 class="widget-title">Get in Touch</h2>
						<ul>
							<li>34/8, East Hukupara, Gifirtok, Sadan.</li>
							<li>support@fruitkha.com</li>
							<li>+00 111 222 3333</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box pages">
						<h2 class="widget-title">Pages</h2>
						<ul>
							<li><a href="/">Home</a></li>
							<li><a href="about.html">About</a></li>
							<li><a href="/shop">Shop</a></li>
							<li><a href="news.html">News</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box subscribe">
						<h2 class="widget-title">Subscribe</h2>
						<p>Subscribe to our mailing list to get the latest updates.</p>
						<form action="index.html">
							<input type="email" placeholder="Email">
							<button type="submit"><i class="fas fa-paper-plane"></i></button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end footer -->
	
	<!-- copyright -->
	<div class="copyright">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-md-12">
					<p>Copyrights &copy; 2019 - <a href="https://imransdesign.com/">Imran Hossain</a>,  All Rights Reserved.<br>
						Distributed By - <a href="https://themewagon.com/">Themewagon</a>
					</p>
				</div>
				<div class="col-lg-6 text-right col-md-12">
					<div class="social-icons">
						<ul>
							<li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end copyright -->
	

	<!-- jquery -->
	<script src="/js/jquery-1.11.3.min.js"></script>
	<!-- bootstrap -->
	<script src="/bootstrap/js/bootstrap.min.js"></script>
	<!-- count down -->
	<script src="/js/jquery.countdown.js"></script>
	<!-- isotope -->
	<script src="/js/jquery.isotope-3.0.6.min.js"></script>
	<!-- waypoints -->
	<script src="/js/waypoints.js"></script>
	<!-- owl carousel -->
	<script src="/js/owl.carousel.min.js"></script>
	<!-- magnific popup -->
	<script src="/js/jquery.magnific-popup.min.js"></script>
	<!-- mean menu -->
	<script src="/js/jquery.meanmenu.min.js"></script>
	<!-- sticker js -->
	<script src="/js/sticker.js"></script>
	<!-- main js -->
	<script src="/js/main.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>  
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script>
	function openDeleteModal(house){
		document.getElementById('addressId').value = house
		// document.getElementById('pincode').value = pincode
	}
	function deleteAddress(){
		const addressId = document.getElementById('addressId').value
		// const name = document.getElementById('pincode').value
		fetch('/deleteAddress',{
			method:'POST',
			headers: {
			'Content-Type': 'application/json'
			},
			body:JSON.stringify({addressId})
		})
		.then(response => {
			$('#unblockBut').modal('hide')
			console.log(response +" this is response")
		}).then(result=>window.location.reload())
		.catch(error=>console.log(error))
		
	}
  </script>

<%- include('../layouts/footer.ejs') %>
<div class="modal fade" id="unblockBut" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
aria-labelledby="staticBackdropLabel" aria-hidden="true">
<div class="modal-dialog">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="staticBackdropLabel">Delete</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      Are you sure you want to Delete this Address?
      <input type="hidden" id="deleteID">
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      <button class="btn btn-danger mt-1 mb-1" onclick="return deleteAddress()" id="unblock-Button">Delete</button>